<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial &#8212; pandarm v0.0.4.dev1+gc432ba547 Manual</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=1efef532"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Network API" href="network.html" />
    <link rel="prev" title="Getting started" href="introduction.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          pandarm</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.4.dev1+gc432ba547</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="installation.html">Installation</a></li>
                <li><a href="introduction.html">Introduction</a></li>
                <li><a href="network.html">Network API</a></li>
                <li><a href="loaders.html">Saving Networks</a></li>
                <li><a href="example_notebook.html">Tutorial</a></li>
                <li><a href="utilities.html">Utilities</a></li>
                <li><a href="references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#standard-installation">Standard installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#compiling-from-source-code">Compiling from source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#advanced-compilation-tips">Advanced compilation tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#multithreading">Multithreading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#general-workflow">General workflow</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-the-network">Create the network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nearest-queries">Nearest queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregation-queries">Aggregation queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#display-the-results">Display the results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="network.html">Network API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="network.html#module-pandarm.network">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="loaders.html">Loaders</a><ul>
<li class="toctree-l2"><a class="reference internal" href="loaders.html#pandas-hdf5">Pandas HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="loaders.html#pandas-hdf5-api">Pandas HDF5 API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#pandarm.utils.reindex"><code class="docutils literal notranslate"><span class="pre">reindex()</span></code></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#create-the-network">Create the network</a></li>
<li><a class="reference internal" href="#nearest-queries">Nearest queries</a></li>
<li><a class="reference internal" href="#aggregation-queries">Aggregation queries</a></li>
<li><a class="reference internal" href="#display-the-results">Display the results</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial was last updated in 2017 and may not be current. The best place
to start is with the pandarm <a class="reference external" href="https://github.com/oturns/pandarm/tree/master/examples/example-notebook.ipynb">demo notebook</a>.</p>
</div>
<p>At this point it is probably helpful to make concrete the topics discussed in
the introduction by giving code sample.  There is also an IPython Notebook
in the <code class="docutils literal notranslate"><span class="pre">pandarm</span></code> repo which gives the entire workflow,
but the discussion here will take things line-by-line with a sufficient
summary of the functionality.</p>
<p>Note that these code samples assume you have imported pandas and pandarm as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandarm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pdna</span>
</pre></div>
</div>
<section id="create-the-network">
<h2>Create the network<a class="headerlink" href="#create-the-network" title="Link to this heading">¶</a></h2>
<p>First create the network.  Although the API is incredibly simple,
this is likely to be the most difficult part of using pandarm.  In the future
we will leverage the import functionality of tools like <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> to
directly access networks via shapefiles,
but for now the initialization <code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.__init__()</span></code>
takes a small number of Pandas Series objects.</p>
<p>The network is comprised of a set of nodes and edges.
We store our nodes and edges as two Pandas DataFrames in an HDFStore object.
We can access them as follows (the demo data file can be
<a class="reference external" href="https://s3-us-west-1.amazonaws.com/synthpop-data2/pandarm/osm_bayarea.h5">downloaded here</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s1">&#39;data/osm_bayarea.h5&#39;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">nodes</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">edges</span>
<span class="nb">print</span> <span class="n">nodes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">edges</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>The output of the above code shows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>              <span class="n">x</span>           <span class="n">y</span>
<span class="mi">8</span>   <span class="mf">629310.1250</span>  <span class="mf">4095536.75</span>
<span class="mi">9</span>   <span class="mf">629120.9375</span>  <span class="mf">4095816.75</span>
<span class="mi">10</span>  <span class="mf">628951.5625</span>  <span class="mf">4096090.50</span>

<span class="p">[</span><span class="mi">3</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">2</span> <span class="n">columns</span><span class="p">]</span>

   <span class="kn">from</span><span class="w">  </span><span class="nn">to</span>      <span class="n">weight</span>
<span class="mi">6</span>     <span class="mi">8</span>   <span class="mi">9</span>  <span class="mf">338.255005</span>
<span class="mi">7</span>     <span class="mi">9</span>  <span class="mi">10</span>  <span class="mf">322.532990</span>
<span class="mi">8</span>    <span class="mi">10</span>  <span class="mi">11</span>  <span class="mf">218.505997</span>

<span class="p">[</span><span class="mi">3</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">3</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>The data structure is very simple indeed.  Nodes have an index which is the
id of the node and an x-y position.  Much like <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, <code class="docutils literal notranslate"><span class="pre">pandarm</span></code> is
agnostic to the  coordinate system.  Use your local coordinate system or
longitude then latitude - either one will work.  Edges are then ids (which
aren’t used) and
<code class="docutils literal notranslate"><span class="pre">from</span></code> node ids and <code class="docutils literal notranslate"><span class="pre">to</span></code> node_ids which should index directly to the node
DataFrame.  A <code class="docutils literal notranslate"><span class="pre">weight</span></code> column (or multiple weight columns) is (are) required
as the impedance for the network.  Here, distance is used from OpenStreetMap
edges.</p>
<p>To create the network given the above DataFrames, simply call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">=</span><span class="n">pdna</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">edges</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span> <span class="n">edges</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">],</span>
                 <span class="n">edges</span><span class="p">[[</span><span class="s2">&quot;weight&quot;</span><span class="p">]])</span>
</pre></div>
</div>
<p>It’s probably a good idea (though not strictly required) to precompute a
given horizon distance so that aggregations don’t perform the network queries
unnecessarily.  This is done by calling the following code,
where 3000 meters is used as the horizon distance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">precompute</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that a large amount of time is spent in the precomputations that take
place for these two lines of code.  On a MacBook, these two lines of code
take 4 seconds and 8.5 seconds respectively.</p>
<p><strong>This was done on a 4-core cpu, so if your precomputation is much slower,
check the IPython Notebook output (on the console) for a statement that says</strong>
<code class="docutils literal notranslate"><span class="pre">Generating</span> <span class="pre">contraction</span> <span class="pre">hierarchies</span> <span class="pre">with</span> <span class="pre">4</span> <span class="pre">threads.</span></code> <strong>If your output says
1 instead of 4 you are running single threaded.  If you are running on
a multi-core cpu, there is probably a way to speed up the computation.</strong></p>
</section>
<section id="nearest-queries">
<h2>Nearest queries<a class="headerlink" href="#nearest-queries" title="Link to this heading">¶</a></h2>
<p>Now for the fun part.  Nearest queries are slightly easier, so let’s cover that
first.</p>
<p>First initialize the POI (point-of-interest) category:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">set_pois</span><span class="p">(</span><span class="s2">&quot;restaurants&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>This code initializes the “restaurants” category with the positions specified
by the x and y columns (which are Pandas Series), at a max distance of 2000 meters
for up to the 10 nearest points-of-interest.  Next perform the query:</p>
<p>Here is a link to the docs: <a class="reference internal" href="network.html#pandarm.network.Network.set_pois" title="pandarm.network.Network.set_pois"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.set_pois()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">nearest_pois</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="s2">&quot;restaurants&quot;</span><span class="p">,</span> <span class="n">num_pois</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This searches for the 10 nearest restaurants and is exactly the query that is
displayed in the introduction.  This returns a DataFrame with the number of
columns equal to the number of POIs that are requested. For instance,
a describe of the output DataFrame look like this (note that the query
executed in half a second:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">1.37</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">11</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">1.38</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mi">498</span> <span class="n">ms</span>
                  <span class="mi">1</span>              <span class="mi">2</span>              <span class="mi">3</span>              <span class="mi">4</span>   \
<span class="n">count</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>
<span class="n">mean</span>     <span class="mf">1542.487481</span>    <span class="mf">1676.578324</span>    <span class="mf">1746.392002</span>    <span class="mf">1794.982571</span>
<span class="n">std</span>       <span class="mf">629.581983</span>     <span class="mf">543.853257</span>     <span class="mf">485.754919</span>     <span class="mf">440.356407</span>
<span class="nb">min</span>         <span class="mf">0.000000</span>       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>
<span class="mi">25</span><span class="o">%</span>      <span class="mf">1063.236542</span>    <span class="mf">1473.924011</span>    <span class="mf">1775.853271</span>    <span class="mf">2000.000000</span>
<span class="mi">50</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="mi">75</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="nb">max</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>

                  <span class="mi">5</span>              <span class="mi">6</span>              <span class="mi">7</span>              <span class="mi">8</span>   \
<span class="n">count</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>
<span class="n">mean</span>     <span class="mf">1825.214545</span>    <span class="mf">1846.061683</span>    <span class="mf">1864.423958</span>    <span class="mf">1879.123914</span>
<span class="n">std</span>       <span class="mf">407.388660</span>     <span class="mf">380.878320</span>     <span class="mf">353.350067</span>     <span class="mf">330.835422</span>
<span class="nb">min</span>         <span class="mf">0.000000</span>       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>       <span class="mf">0.000000</span>
<span class="mi">25</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="mi">50</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="mi">75</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="nb">max</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>

                  <span class="mi">9</span>              <span class="mi">10</span>
<span class="n">count</span>  <span class="mf">226060.000000</span>  <span class="mf">226060.000000</span>
<span class="n">mean</span>     <span class="mf">1893.909935</span>    <span class="mf">1908.403787</span>
<span class="n">std</span>       <span class="mf">306.340819</span>     <span class="mf">283.554353</span>
<span class="nb">min</span>         <span class="mf">0.000000</span>      <span class="mf">56.143002</span>
<span class="mi">25</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="mi">50</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="mi">75</span><span class="o">%</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>
<span class="nb">max</span>      <span class="mf">2000.000000</span>    <span class="mf">2000.000000</span>

<span class="p">[</span><span class="mi">8</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">10</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>Here is a link to the docs: <a class="reference internal" href="network.html#pandarm.network.Network.nearest_pois" title="pandarm.network.Network.nearest_pois"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.nearest_pois()</span></code></a></p>
</section>
<section id="aggregation-queries">
<h2>Aggregation queries<a class="headerlink" href="#aggregation-queries" title="Link to this heading">¶</a></h2>
<p>Performing a general network aggregation isn’t much harder.  In this case,
it is assumed that DataFrames are much larger and that queries have
a lot more variety.</p>
<p>For this reason, the workflow is typically to map the variables x and y to
node_ids (which can then be cached or written to disk at a later date) and
to call <code class="docutils literal notranslate"><span class="pre">set</span></code> for each data column, potentially several times.  For instance,
if you have a DataFrame of buildings with x and y coordinates,
you can use <code class="docutils literal notranslate"><span class="pre">get_node_ids</span></code> to set node_ids as an attribute on the
buildings table and then <code class="docutils literal notranslate"><span class="pre">set</span></code> can be called many times with all the
attributes of the buildings table and their associated column names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">buildings</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">buildings</span><span class="o">.</span><span class="n">y</span>
<span class="n">buildings</span><span class="p">[</span><span class="s2">&quot;node_ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_node_ids</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_ids</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">buildings</span><span class="o">.</span><span class="n">square_footage</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square_footage&quot;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_ids</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">buildings</span><span class="o">.</span><span class="n">residential_units</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;residential_units&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a link to the docs: <a class="reference internal" href="network.html#pandarm.network.Network.get_node_ids" title="pandarm.network.Network.get_node_ids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.get_node_ids()</span></code></a>
and <a class="reference internal" href="network.html#pandarm.network.Network.set" title="pandarm.network.Network.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.set()</span></code></a></p>
<p>Once the variables have been assigned to the network, the user can query the
network repeatedly with different parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square_footage&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square_footage&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square_footage&quot;</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square_footage&quot;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ave&quot;</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;residential_units&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a link to the docs: <a class="reference internal" href="network.html#pandarm.network.Network.aggregate" title="pandarm.network.Network.aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandarm.network.Network.aggregate()</span></code></a></p>
<p>Note that if networks have been indexed and precomputed,
the aggregations should take less than a second up to a distance of roughly
three kilometers for a network with a few hundred thousand nodes.</p>
</section>
<section id="display-the-results">
<h2>Display the results<a class="headerlink" href="#display-the-results" title="Link to this heading">¶</a></h2>
<p>An experimental feature for displaying the points of the node_ids and their
associated computed values using matplotlib (so that the entire workflow can
happen in the notebook) is also available.</p>
<p>Note that these have a bounding box for reducing the display window.
Although the underlying library is computing values for all nodes in the
region, it is difficult to visualize this much data using
matplotlib.  For quick interactive checking of results,
the bounding box can be used to reduce the number of points that are shown,
and sample code and images are included below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sf_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mf">37.707794</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.524338</span><span class="p">,</span> <span class="mf">37.834192</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.34993</span><span class="p">]</span>

<span class="n">net</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">sf_bbox</span><span class="p">,</span>
         <span class="n">fig_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]},</span>
         <span class="n">bmap_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;suppress_ticks&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="s1">&#39;resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;epsg&#39;</span><span class="p">:</span> <span class="s1">&#39;26943&#39;</span><span class="p">},</span>
         <span class="n">plot_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;BrBG&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/500metersum.png" src="_images/500metersum.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">sf_bbox</span><span class="p">,</span>
         <span class="n">fig_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]},</span>
         <span class="n">bmap_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;suppress_ticks&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="s1">&#39;resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;epsg&#39;</span><span class="p">:</span> <span class="s1">&#39;26943&#39;</span><span class="p">},</span>
         <span class="n">plot_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;BrBG&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>
</pre></div>
</div>
<img alt="_images/2000metersum.png" src="_images/2000metersum.png" />
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/tutorial.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2025, pandarm developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>